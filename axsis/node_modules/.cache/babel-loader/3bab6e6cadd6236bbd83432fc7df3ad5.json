{"ast":null,"code":"const util = require('../util');\n\nconst yaml = require('yamljs');\n\nconst jsesc = require('jsesc');\n\nconst querystring = require('querystring');\n\nfunction getDataString(request) {\n  let mimeType = 'application/json';\n\n  if (typeof request.data === 'number') {\n    request.data = request.data.toString();\n    mimeType = 'text/plain';\n  }\n\n  if (request.data.indexOf(\"'\") > -1) {\n    request.data = jsesc(request.data);\n  }\n\n  const parsedQueryString = querystring.parse(request.data);\n  const keyCount = Object.keys(parsedQueryString).length;\n  const singleKeyOnly = keyCount === 1 && !parsedQueryString[Object.keys(parsedQueryString)[0]];\n  const singularData = request.isDataBinary || singleKeyOnly;\n\n  if (singularData) {\n    return {\n      mimeType: mimeType,\n      text: JSON.parse(request.data)\n    };\n  } else {\n    for (const paramName in request.headers) {\n      if (paramName === 'Content-Type') {\n        mimeType = request.headers[paramName];\n      }\n    }\n\n    return {\n      mimeType: mimeType,\n      text: request.data\n    };\n  }\n}\n\nfunction getQueryList(request) {\n  const queryList = [];\n\n  for (const paramName in request.query) {\n    const rawValue = request.query[paramName];\n    queryList.push({\n      name: paramName,\n      value: rawValue\n    });\n  }\n\n  return queryList;\n}\n\nconst toStrest = curlCommand => {\n  const request = util.parseCurlCommand(curlCommand);\n  const response = {\n    version: 2\n  };\n\n  if (request.insecure) {\n    response.allowInsecure = true;\n  }\n\n  if (request.urlWithoutQuery.indexOf('http') !== 0) {\n    request.urlWithoutQuery = 'http://' + request.urlWithoutQuery;\n  }\n\n  response.requests = {\n    curl_converter: {\n      request: {\n        url: request.urlWithoutQuery.toString(),\n        method: request.method.toUpperCase()\n      }\n    }\n  };\n\n  if (typeof request.data === 'string' || typeof request.data === 'number') {\n    response.requests.curl_converter.request.postData = getDataString(request);\n  }\n\n  if (request.headers) {\n    response.requests.curl_converter.request.headers = [];\n\n    for (const prop in request.headers) {\n      response.requests.curl_converter.request.headers.push({\n        name: prop,\n        value: request.headers[prop]\n      });\n    }\n\n    if (request.cookieString) {\n      response.requests.curl_converter.request.headers.push({\n        name: 'Cookie',\n        value: request.cookieString\n      });\n    }\n  }\n\n  if (request.auth) {\n    response.requests.curl_converter.auth = {\n      basic: {}\n    };\n\n    if (request.auth.split(':')[0]) {\n      response.requests.curl_converter.auth.basic.username = request.auth.split(':')[0];\n    }\n\n    response.requests.curl_converter.auth.basic.password = request.auth.split(':')[1];\n  }\n\n  let queryList;\n\n  if (request.query) {\n    queryList = getQueryList(request);\n    response.requests.curl_converter.request.queryString = queryList;\n  }\n\n  const yamlString = yaml.stringify(response, 100, 2);\n  return yamlString;\n};\n\nmodule.exports = toStrest;","map":{"version":3,"sources":["/home/marcel/Desktop/CobaProject/GUI backless-js/axsis/node_modules/curlconverter/generators/strest.js"],"names":["util","require","yaml","jsesc","querystring","getDataString","request","mimeType","data","toString","indexOf","parsedQueryString","parse","keyCount","Object","keys","length","singleKeyOnly","singularData","isDataBinary","text","JSON","paramName","headers","getQueryList","queryList","query","rawValue","push","name","value","toStrest","curlCommand","parseCurlCommand","response","version","insecure","allowInsecure","urlWithoutQuery","requests","curl_converter","url","method","toUpperCase","postData","prop","cookieString","auth","basic","split","username","password","queryString","yamlString","stringify","module","exports"],"mappings":"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","sourcesContent":["const util = require('../util')\nconst yaml = require('yamljs')\nconst jsesc = require('jsesc')\nconst querystring = require('querystring')\n\nfunction getDataString (request) {\n  let mimeType = 'application/json'\n  if (typeof request.data === 'number') {\n    request.data = request.data.toString()\n    mimeType = 'text/plain'\n  }\n  if (request.data.indexOf(\"'\") > -1) {\n    request.data = jsesc(request.data)\n  }\n  const parsedQueryString = querystring.parse(request.data)\n  const keyCount = Object.keys(parsedQueryString).length\n  const singleKeyOnly = keyCount === 1 && !parsedQueryString[Object.keys(parsedQueryString)[0]]\n  const singularData = request.isDataBinary || singleKeyOnly\n  if (singularData) {\n    return {\n      mimeType: mimeType,\n      text: JSON.parse(request.data)\n    }\n  } else {\n    for (const paramName in request.headers) {\n      if (paramName === 'Content-Type') {\n        mimeType = request.headers[paramName]\n      }\n    }\n    return {\n      mimeType: mimeType,\n      text: request.data\n    }\n  }\n}\n\nfunction getQueryList (request) {\n  const queryList = []\n  for (const paramName in request.query) {\n    const rawValue = request.query[paramName]\n    queryList.push({ name: paramName, value: rawValue })\n  }\n  return queryList\n}\n\nconst toStrest = curlCommand => {\n  const request = util.parseCurlCommand(curlCommand)\n  const response = { version: 2 }\n  if (request.insecure) {\n    response.allowInsecure = true\n  }\n  if (request.urlWithoutQuery.indexOf('http') !== 0) {\n    request.urlWithoutQuery = 'http://' + request.urlWithoutQuery\n  }\n  response.requests = {\n    curl_converter: {\n      request: {\n        url: request.urlWithoutQuery.toString(),\n        method: request.method.toUpperCase()\n      }\n    }\n  }\n  if (typeof request.data === 'string' || typeof request.data === 'number') {\n    response.requests.curl_converter.request.postData = getDataString(request)\n  }\n\n  if (request.headers) {\n    response.requests.curl_converter.request.headers = []\n    for (const prop in request.headers) {\n      response.requests.curl_converter.request.headers.push({\n        name: prop,\n        value: request.headers[prop]\n      })\n    }\n    if (request.cookieString) {\n      response.requests.curl_converter.request.headers.push({\n        name: 'Cookie',\n        value: request.cookieString\n      })\n    }\n  }\n  if (request.auth) {\n    response.requests.curl_converter.auth = {\n      basic: {}\n    }\n    if (request.auth.split(':')[0]) {\n      response.requests.curl_converter.auth.basic.username = request.auth.split(':')[0]\n    }\n    response.requests.curl_converter.auth.basic.password = request.auth.split(':')[1]\n  }\n\n  let queryList\n  if (request.query) {\n    queryList = getQueryList(request)\n    response.requests.curl_converter.request.queryString = queryList\n  }\n\n  const yamlString = yaml.stringify(response, 100, 2)\n  return yamlString\n}\n\nmodule.exports = toStrest\n"]},"metadata":{},"sourceType":"script"}